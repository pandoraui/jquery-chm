<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>jQuery.callbacks(flags) | jQuery API ä¸­æ–‡æ‰‹å†Œ</title>
<meta name="author" content="jQuery ä¸­æ–‡æ‰‹å†Œ - hemin.cn/jq/">
<meta name="description" content="jQueryä¸­æ–‡æ‰‹å†Œ(åœ¨çº¿ç‰ˆ),ä½œè€…:hemin,åœ¨çº¿æ‰‹å†Œ:hemin.cn/jq/,ä¸‹è½½:hemin.cn/jq/downloads/">
<link type="text/css" rel="stylesheet" href="style/style.css" tppabs="http://hemin.cn/jq/style/style.css"  />
<script type="text/javascript" src="js/jquery.min.js" tppabs="http://hemin.cn/jq/js/jquery.min.js"></script>
<script type="text/javascript" src="js/js.js" tppabs="http://hemin.cn/jq/js/js.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44050237-1', 'hemin.cn');
  ga('send', 'pageview');
</script>
</head>
<body id="split">
<div id="content" class="a2">
  <div rel="jQuery.callbacks">
    <h2><span>è¿”å›å€¼:jQuery</span>jQuery.callbacks(flags)</h2>
    <h3>æ¦‚è¿°</h3>
    <div class="desc">
      <p> ä¸€ä¸ªå¤šç”¨é€”çš„å›è°ƒåˆ—è¡¨å¯¹è±¡ï¼Œæä¾›äº†å¼ºå¤§çš„çš„æ–¹å¼æ¥ç®¡ç†å›è°ƒå‡½æ•°åˆ—è¡¨ã€‚ </p>
      <div class="longdesc">
        <p>$.Callbacks()çš„å†…éƒ¨æä¾›äº†jQueryçš„$.ajax()&nbsp;å’Œ&nbsp;$.Deferred()&nbsp;åŸºæœ¬åŠŸèƒ½ç»„ä»¶ã€‚å®ƒå¯ä»¥ç”¨æ¥ä½œä¸ºç±»ä¼¼åŸºç¡€å®šä¹‰çš„æ–°ç»„ä»¶çš„åŠŸèƒ½ã€‚</p>
        <p>$.Callbacks()&nbsp;æ”¯æŒçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬&nbsp;<a href="javascript:if(confirm('http://www.css88.com/callbacks.add/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://www.css88.com/callbacks.add/'" tppabs="http://www.css88.com/callbacks.add/">callbacks.add()</a>,<a href="javascript:if(confirm('http://www.css88.com/callbacks.remove/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://www.css88.com/callbacks.remove/'" tppabs="http://www.css88.com/callbacks.remove/">callbacks.remove()</a>,&nbsp;<a href="javascript:if(confirm('http://www.css88.com/callbacks.fire/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://www.css88.com/callbacks.fire/'" tppabs="http://www.css88.com/callbacks.fire/">callbacks.fire()</a>&nbsp;and&nbsp;<a href="javascript:if(confirm('http://www.css88.com/callbacks.disable/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://www.css88.com/callbacks.disable/'" tppabs="http://www.css88.com/callbacks.disable/">callbacks.disable()</a>.</p>
      </div>
    </div>
    <h3>å‚æ•°</h3>
    <div class="parameter">
      <h4><strong>flags</strong><em>V1.7</em></h4>
      <p> ä¸€ä¸ªç”¨ç©ºæ ¼æ ‡è®°åˆ†éš”çš„æ ‡å¿—å¯é€‰åˆ—è¡¨,ç”¨æ¥æ”¹å˜å›è°ƒåˆ—è¡¨ä¸­çš„è¡Œä¸º </p>
    </div>
    <div class="example">
      <h3>ç¤ºä¾‹</h3>
      <span id="f_ad2"></span>
      <h4>å…¥é—¨æè¿°:</h4>
      <p> ä»¥ä¸‹æ˜¯ä¸¤ä¸ªæ ·å“çš„æ–¹æ³•å‘½åfn1&nbsp;and&nbsp;fn2: </p>
      <h5>jQuery ä»£ç :</h5>
      <pre><code>function fn1( value ){
    console.log( value );
}

function fn2( value ){
    fn1("fn2 says:" + value);
    return false;
}</code></pre>
      <p>è¿™äº›å¯ä»¥æ·»åŠ ä¸ºå›è°ƒå‡½æ•°ä½œä¸ºä¸€ä¸ª$.Callbacksçš„åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨å¦‚ä¸‹:</p>
      <pre><code>var callbacks = $.Callbacks();
callbacks.add( fn1 );
callbacks.fire( "foo!" ); // outputs: foo!

callbacks.add( fn2 );
callbacks.fire( "bar!" ); // outputs: bar!, fn2 says: bar!</code></pre>
      <p>è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œå®ƒä½¿æ„é€ å¤æ‚çš„å›è°ƒåˆ—è¡¨å˜å¾—ç®€å•ï¼Œè¾“å…¥å€¼å¯ä»¥é€šè¿‡å°½å¯èƒ½å¤šçš„å‡½æ•°æ ¹æ®éœ€è¦è½»æ¾ä½¿ç”¨ã€‚</p>
      <p>ç”¨äºä»¥ä¸Šçš„ä¸¤ä¸ªå…·ä½“çš„æ–¹æ³•ï¼š&nbsp;.add()&nbsp;å’Œ&nbsp;.fire()&nbsp;.add() æ”¯æŒæ·»åŠ æ–°çš„å›è°ƒå›è°ƒåˆ—è¡¨, è€Œ.fire()&nbsp;æä¾›äº†ä¸€ç§ç”¨äºå¤„ç†åœ¨åŒä¸€åˆ—è¡¨ä¸­çš„å›è°ƒæ–¹æ³•çš„é€”å¾„.</p>
      <p>å¦ä¸€ç§æ–¹æ³•ç”±$.Callbacks&nbsp;çš„remove()ï¼Œç”¨äºä»å›è°ƒåˆ—è¡¨ä¸­åˆ é™¤ä¸€ä¸ªç‰¹å®šçš„å›è°ƒã€‚ä¸‹é¢æ˜¯.remove() ä½¿ç”¨çš„ä¸€ä¸ªä¾‹å­:</p>
      <pre><code>var callbacks = $.Callbacks();
callbacks.add( fn1 );
callbacks.fire( "foo!" ); // outputs: foo!

callbacks.add( fn2 );
callbacks.fire( "bar!" ); // outputs: bar!, fn2 says: bar!

callbacks.remove(fn2);
callbacks.fire( "foobar" ); 

// only outputs foobar, as fn2 has been removed.</code></pre>
      <h4>æ”¯æŒçš„ Flagsæè¿°:</h4>
      <p>è¿™ä¸ª flags å‚æ•°æ˜¯$.Callbacks()çš„ä¸€ä¸ªå¯é€‰å‚æ•°, ç»“æ„ä¸ºä¸€ä¸ªç”¨ç©ºæ ¼æ ‡è®°åˆ†éš”çš„æ ‡å¿—å¯é€‰åˆ—è¡¨,ç”¨æ¥æ”¹å˜å›è°ƒåˆ—è¡¨ä¸­çš„è¡Œä¸º (æ¯”å¦‚. $.Callbacks( 'unique stopOnFalse' )).</p>
      <p>&nbsp;</p>
      <p><strong>å¯ç”¨çš„ flags: </strong></p>
      <ul>
        <li>once: ç¡®ä¿è¿™ä¸ªå›è°ƒåˆ—è¡¨åªæ‰§è¡Œä¸€æ¬¡(åƒä¸€ä¸ªé€’å»¶ Deferred).</li>
        <li>memory: ä¿æŒä»¥å‰çš„å€¼å’Œå°†æ·»åŠ åˆ°è¿™ä¸ªåˆ—è¡¨çš„åé¢çš„æœ€æ–°çš„å€¼ç«‹å³æ‰§è¡Œè°ƒç”¨ä»»ä½•å›è°ƒ (åƒä¸€ä¸ªé€’å»¶ Deferred).</li>
        <li>unique: ç¡®ä¿ä¸€æ¬¡åªèƒ½æ·»åŠ ä¸€ä¸ªå›è°ƒ(æ‰€ä»¥æœ‰æ²¡æœ‰åœ¨åˆ—è¡¨ä¸­çš„é‡å¤).</li>
        <li>stopOnFalse: å½“ä¸€ä¸ªå›è°ƒè¿”å›false æ—¶ä¸­æ–­è°ƒç”¨</li>
      </ul>
      <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå›è°ƒåˆ—è¡¨å°†åƒäº‹ä»¶çš„å›è°ƒåˆ—è¡¨ä¸­å¯ä»¥å¤šæ¬¡è§¦å‘ã€‚</p>
      <p>å¦‚ä½•åœ¨ç†æƒ³æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨çš„flagsçš„ä¾‹å­ï¼Œè§ä¸‹æ–‡ï¼š</p>
      <p>&nbsp;</p>
      <p><strong>$.Callbacks( 'once' ):</strong></p>
      <pre><code>var callbacks = $.Callbacks( "once" );
callbacks.add( fn1 );
callbacks.fire( "foo" );
callbacks.add( fn2 );
callbacks.fire( "bar" );
callbacks.remove( fn2 );
callbacks.fire( "foobar" );

/*
output: 
foo
*/</code></pre>
      <p>&nbsp;</p>
      <p><strong>$.Callbacks( 'memory' ):</strong></p>
      <pre><code>var callbacks = $.Callbacks( "memory" );
callbacks.add( fn1 );
callbacks.fire( "foo" );
callbacks.add( fn2 );
callbacks.fire( "bar" );
callbacks.remove( fn2 );
callbacks.fire( "foobar" );

/*
output:
foo
fn2 says:foo
bar
fn2 says:bar
foobar
*/</code></pre>
      <p>&nbsp;</p>
      <p><strong>$.Callbacks( 'unique' ):</strong></p>
      <pre><code>var callbacks = $.Callbacks( "unique" );
callbacks.add( fn1 );
callbacks.fire( "foo" );
callbacks.add( fn1 ); // repeat addition
callbacks.add( fn2 );
callbacks.fire( "bar" );
callbacks.remove( fn2 );
callbacks.fire( "foobar" );

/*
output:
foo
bar
fn2 says:bar
foobar
*//code></pre>
      <p>&nbsp;</p>
      <p><strong>$.Callbacks( 'stopOnFalse' ):</strong></p>
      <pre><code>function fn1( value ){
    console.log( value );
    return false;
}

function fn2( value ){
    fn1("fn2 says:" + value);
    return false;
}

var callbacks = $.Callbacks( "stopOnFalse");
callbacks.add( fn1 );
callbacks.fire( "foo" );
callbacks.add( fn2 );
callbacks.fire( "bar" );
callbacks.remove( fn2 );
callbacks.fire( "foobar" );

/*
output:
foo
bar
foobar
*/</code></pre>
      <p> å› ä¸º$.Callbacks() æ”¯æŒä¸€ä¸ªåˆ—è¡¨çš„flagsè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªï¼Œè®¾ç½®å‡ ä¸ªflagsï¼Œæœ‰ä¸€ä¸ªç´¯ç§¯æ•ˆåº”ï¼Œç±»ä¼¼&ldquo;&amp;&amp;&rdquo;ã€‚è¿™æ„å‘³ç€å®ƒå¯èƒ½ç»“åˆåˆ›å»ºå›è°ƒåå•ï¼Œ<em>unique</em>&nbsp;å’Œ<em>ç¡®ä¿å¦‚æœåå•å·²ç»è§¦å‘ï¼Œå°†æœ‰æ›´å¤šçš„å›è°ƒè°ƒç”¨æœ€æ–°çš„è§¦å‘å€¼</em>&nbsp;(i.e.$.Callbacks(&quot;unique memory&quot;)). </p>
      <p>&nbsp;</p>
      <p><strong>$.Callbacks( 'unique memory' ):</strong></p>
      <pre><code>function fn1( value ){
    console.log( value );
    return false;
}

function fn2( value ){
    fn1("fn2 says:" + value);
    return false;
}
    
var callbacks = $.Callbacks( "unique memory" );
callbacks.add( fn1 );
callbacks.fire( "foo" );
callbacks.add( fn1 ); // repeat addition
callbacks.add( fn2 );
callbacks.fire( "bar" );
callbacks.add( fn2 );
callbacks.fire( "baz" );
callbacks.remove( fn2 );
callbacks.fire( "foobar" );

/*
output:
foo
fn2 says:foo
bar
fn2 says:bar
baz
fn2 says:baz
foobar
*/</code></pre>
      <p>Flagç»“åˆä½“æ˜¯ä½¿ç”¨çš„$.Callbacks()å†…éƒ¨çš„.done()&nbsp;å’Œ&nbsp;.fail()ä¸€ä¸ªé€’å»¶å®¹å™¨-å®ƒä»¬éƒ½ä½¿ç”¨&nbsp;$.Callbacks('memory once').</p>
      <p>$.Callbacks æ–¹æ³•ä¹Ÿå¯ä»¥è¢«åˆ†ç¦», ä¸ºæ–¹ä¾¿èµ·è§åº”è¯¥æœ‰ä¸€ä¸ªéœ€è¦å®šä¹‰ç®€å†™ç‰ˆæœ¬ï¼š</p>
      <pre><code>var callbacks = $.Callbacks(),
    add = callbacks.add,
    remove = callbacks.remove,
    fire = callbacks.fire;

add( fn1 );
fire( "hello world");
remove( fn1 );</code></pre>
      <h4>$.Callbacks, $.Deferred and Pub/Sub</h4>
      <p> pub / subï¼ˆ Observeræ¨¡å¼ï¼‰èƒŒåçš„ä¸€èˆ¬æ€è·¯ æ˜¯ä¿ƒè¿›åº”ç”¨ç¨‹åºçš„æ¾æ•£è€¦åˆã€‚è€Œæ¯”å¯¹å…¶ä»–å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨çš„å•ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡æˆ–æ´»åŠ¨ï¼Œå¹¶é€šçŸ¥å½“å®ƒå‘ç”Ÿã€‚è§‚å¯Ÿå®¶ä¹Ÿè¢«ç§°ä¸ºè®¢é˜…è€…ï¼Œæˆ‘ä»¬æŒ‡çš„å‡ºç‰ˆå•†ï¼ˆæˆ–ä¸»ä½“ï¼‰è§‚å¯Ÿå¯¹è±¡ã€‚å‡ºç‰ˆå•†äº‹ä»¶å‘ç”Ÿæ—¶é€šçŸ¥ç”¨æˆ· </p>
      <p> ä½œä¸ºä¸€ä¸ªç»„ä»¶$.Callbacks()åˆ›é€ èƒ½åŠ›ï¼Œå®ƒå¯ä»¥å®ç°ä¸€ä¸ªpub / subç³»ç»Ÿåªä½¿ç”¨å›è°ƒåˆ—è¡¨ã€‚ä½¿ç”¨$.Callbacksä½œä¸ºä¸»é¢˜é˜Ÿåˆ—ï¼Œå‘å¸ƒå’Œè®¢é˜…çš„ä¸»é¢˜ç³»ç»Ÿå¯ä»¥å®ç°å¦‚ä¸‹: </p>
      <pre><code>var topics = {};

jQuery.Topic = function( id ) {
    var callbacks,
        method,
        topic = id && topics[ id ];
    if ( !topic ) {
        callbacks = jQuery.Callbacks();
        topic = {
            publish: callbacks.fire,
            subscribe: callbacks.add,
            unsubscribe: callbacks.remove
        };
        if ( id ) {
            topics[ id ] = topic;
        }
    }
    return topic;
};</code></pre>
      <p>ç„¶åï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨è¿™éƒ¨åˆ†åº”ç”¨ç¨‹åºçš„å‘å¸ƒå’Œè®¢é˜…æ„Ÿå…´è¶£çš„äº‹ä»¶ï¼š</p>
      <pre><code>// Subscribers
$.Topic( "mailArrived" ).subscribe( fn1 );
$.Topic( "mailArrived" ).subscribe( fn2 );
$.Topic( "mailSent" ).subscribe( fn1 );

// Publisher
$.Topic( "mailArrived" ).publish( "hello world!" );
$.Topic( "mailSent" ).publish( "woo! mail!" );

// Here, "hello world!" gets pushed to fn1 and fn2
// when the "mailArrived" notification is published
// with "woo! mail!" also being pushed to fn1 when
// the "mailSent" notification is published. 

/*
output:
hello world!
fn2 says: hello world!
woo! mail!
*/</code></pre>
      <p>è™½ç„¶è¿™æ˜¯æœ‰ç”¨çš„ï¼Œå¯ä»¥é‡‡å–è¿›ä¸€æ­¥çš„å®æ–½ã€‚ä½¿ç”¨$.Deferreds,è¿™æ˜¯å¯èƒ½çš„ï¼Œä»¥ç¡®ä¿å‘è¡¨è€…åªä¸ºç”¨æˆ·å‘å¸ƒä¸€æ¬¡ç‰¹åˆ«çš„ä»»åŠ¡å·²ç»å®Œæˆï¼ˆè§£å†³ï¼‰é€šçŸ¥ã€‚è¿™å¯èƒ½æ˜¯å¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨çš„ä¸€äº›è¿›ä¸€æ­¥çš„è¯„è®ºï¼Œè¯·å‚è§ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼š</p>
      <pre><code>// subscribe to the mailArrived notification
$.Topic( "mailArrived" ).subscribe( fn1 );

// create a new instance of Deferreds
var dfd = $.Deferred();

// define a new topic (without directly publishing)
var topic = $.Topic( "mailArrived" );

// when the deferred has been resolved, publish a 
// notification to subscribers
dfd.done( topic.publish );

// Here the Deferred is being resolved with a message
// that will be passed back to subscribers. It's possible to
// easily integrate this into a more complex routine
// (eg. waiting on an ajax call to complete) so that
// messages are only published once the task has actually
// finished.
dfd.resolve( "its been published!" );</code></pre>
    </div>
  </div>
</div>
</body>
</html>